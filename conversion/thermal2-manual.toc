\contentsline {section}{\numberline {1}Foreword}{2}{section.1}%
\contentsline {subsection}{\numberline {1.1}Copyright}{2}{subsection.1.1}%
\contentsline {subsection}{\numberline {1.2}Citing}{2}{subsection.1.2}%
\contentsline {section}{\numberline {2}Table of contents}{2}{section.2}%
\contentsline {section}{\numberline {3}Quick Reference Manual}{2}{section.3}%
\contentsline {subsection}{\numberline {3.1}Compiling the code}{2}{subsection.3.1}%
\contentsline {subsection}{\numberline {3.2}List of codes}{2}{subsection.3.2}%
\contentsline {subsubsection}{\numberline {3.2.1}Main codes}{3}{subsubsection.3.2.1}%
\contentsline {paragraph}{\numberline {3.2.1.1}Harmonic phonons (d3\_r2q.x)}{3}{paragraph.3.2.1.1}%
\contentsline {paragraph}{\numberline {3.2.1.2}Quasi harmonic approximation (d3\_qha.x)}{3}{paragraph.3.2.1.2}%
\contentsline {paragraph}{\numberline {3.2.1.3}Third order linewidth (d3\_lw.x).}{3}{paragraph.3.2.1.3}%
\contentsline {paragraph}{\numberline {3.2.1.4}Thermal conductivity (d3\_tk.x)}{3}{paragraph.3.2.1.4}%
\contentsline {paragraph}{\numberline {3.2.1.5}Temperature-dependent phonons (d3\_tdph.x)}{3}{paragraph.3.2.1.5}%
\contentsline {subsubsection}{\numberline {3.2.2}Thermal2 utilities}{3}{subsubsection.3.2.2}%
\contentsline {paragraph}{\numberline {3.2.2.1}d3\_q2r.x}{3}{paragraph.3.2.2.1}%
\contentsline {paragraph}{\numberline {3.2.2.2}d3\_qq2rr.x}{3}{paragraph.3.2.2.2}%
\contentsline {paragraph}{\numberline {3.2.2.3}d3\_sparse.x}{4}{paragraph.3.2.2.3}%
\contentsline {paragraph}{\numberline {3.2.2.4}d3\_asr3.x}{4}{paragraph.3.2.2.4}%
\contentsline {paragraph}{\numberline {3.2.2.5}d3\_recenter.x}{5}{paragraph.3.2.2.5}%
\contentsline {paragraph}{\numberline {3.2.2.6}d3\_import\_shengbte.x}{5}{paragraph.3.2.2.6}%
\contentsline {paragraph}{\numberline {3.2.2.7}d3\_sqom.x}{5}{paragraph.3.2.2.7}%
\contentsline {subsubsection}{\numberline {3.2.3}Experimental codes:}{6}{subsubsection.3.2.3}%
\contentsline {paragraph}{\numberline {3.2.3.1}d3\_db.x}{6}{paragraph.3.2.3.1}%
\contentsline {subsubsection}{\numberline {3.2.4}Tools}{6}{subsubsection.3.2.4}%
\contentsline {paragraph}{\numberline {3.2.4.1}funcoft.sh}{6}{paragraph.3.2.4.1}%
\contentsline {paragraph}{\numberline {3.2.4.2}recompute-sma.m}{6}{paragraph.3.2.4.2}%
\contentsline {paragraph}{\numberline {3.2.4.3}diffd3.x}{6}{paragraph.3.2.4.3}%
\contentsline {paragraph}{\numberline {3.2.4.4}d3\_sc2c.x}{6}{paragraph.3.2.4.4}%
\contentsline {paragraph}{\numberline {3.2.4.5}xml2giorgia.x}{6}{paragraph.3.2.4.5}%
\contentsline {paragraph}{\numberline {3.2.4.6}apply\_asr.sh}{7}{paragraph.3.2.4.6}%
\contentsline {paragraph}{\numberline {3.2.4.7}import\_phonopy.py}{7}{paragraph.3.2.4.7}%
\contentsline {paragraph}{\numberline {3.2.4.8}fc2mat2R.sh}{7}{paragraph.3.2.4.8}%
\contentsline {paragraph}{\numberline {3.2.4.9}apply\_asr.sh}{7}{paragraph.3.2.4.9}%
\contentsline {section}{\numberline {4}Codes input and output}{7}{section.4}%
\contentsline {subsection}{\numberline {4.1}d3\_r2q.x code}{7}{subsection.4.1}%
\contentsline {subsubsection}{\numberline {4.1.1}Namelist \&r2qinput}{7}{subsubsection.4.1.1}%
\contentsline {paragraph}{\numberline {4.1.1.1}calculation (CHARACTER, default: \enquote {freq})}{7}{paragraph.4.1.1.1}%
\contentsline {paragraph}{\numberline {4.1.1.2}prefix (CHARACTER, default: the value of calculation)}{8}{paragraph.4.1.1.2}%
\contentsline {paragraph}{\numberline {4.1.1.3}outdir (CHARACTER, default: \enquote {./}, I.e. the current directory)}{8}{paragraph.4.1.1.3}%
\contentsline {paragraph}{\numberline {4.1.1.4}file\_mat2 (CHARACTER, no default)}{8}{paragraph.4.1.1.4}%
\contentsline {paragraph}{\numberline {4.1.1.5}asr2 (CHARACTER, default: \enquote {no})}{8}{paragraph.4.1.1.5}%
\contentsline {paragraph}{\numberline {4.1.1.6}nq (INTEGER, no default)}{8}{paragraph.4.1.1.6}%
\contentsline {paragraph}{\numberline {4.1.1.7}print\_dynmat (LOGICAL, default: .false.)}{8}{paragraph.4.1.1.7}%
\contentsline {paragraph}{\numberline {4.1.1.8}sort\_freq (CHARACTER, default: \enquote {default})}{8}{paragraph.4.1.1.8}%
\contentsline {paragraph}{\numberline {4.1.1.9}print\_velocity (LOGICAL, default: .false.)}{8}{paragraph.4.1.1.9}%
\contentsline {paragraph}{\numberline {4.1.1.10}ne, de, e0, sigma\_e (INTEGER, REAL, REAL, in cm-1 no default)}{8}{paragraph.4.1.1.10}%
\contentsline {subsubsection}{\numberline {4.1.2}Output format}{9}{subsubsection.4.1.2}%
\contentsline {subsection}{\numberline {4.2}d3\_qha.x code}{9}{subsection.4.2}%
\contentsline {subsubsection}{\numberline {4.2.1}Namelist \&qhainput}{9}{subsubsection.4.2.1}%
\contentsline {paragraph}{\numberline {4.2.1.1}calculation (CHARACTER, default: \enquote {gibbs})}{9}{paragraph.4.2.1.1}%
\contentsline {paragraph}{\numberline {4.2.1.2}prefix (CHARACTER, default: the value of calculation)}{9}{paragraph.4.2.1.2}%
\contentsline {paragraph}{\numberline {4.2.1.3}outdir (CHARACTER, default: \enquote {./}, i.e.\nobreakspace {}the current directory)}{9}{paragraph.4.2.1.3}%
\contentsline {paragraph}{\numberline {4.2.1.4}nT, dT, T0 (INTEGER, REAL, REAL, in K)}{9}{paragraph.4.2.1.4}%
\contentsline {paragraph}{\numberline {4.2.1.5}asr2 (CHARACTER, default: \enquote {no})}{9}{paragraph.4.2.1.5}%
\contentsline {paragraph}{\numberline {4.2.1.6}nk (3x INTEGER, no default)}{9}{paragraph.4.2.1.6}%
\contentsline {paragraph}{\numberline {4.2.1.7}grid\_type (CHARACTER, default: \enquote {simple})}{9}{paragraph.4.2.1.7}%
\contentsline {paragraph}{\numberline {4.2.1.8}press\_kbar (REAL, kbar, 0)}{9}{paragraph.4.2.1.8}%
\contentsline {paragraph}{\numberline {4.2.1.9}press\_Gpa (REAL, Gpa, 0)}{10}{paragraph.4.2.1.9}%
\contentsline {paragraph}{\numberline {4.2.1.10}n\_volumes (INTEGER, no default)}{10}{paragraph.4.2.1.10}%
\contentsline {subsubsection}{\numberline {4.2.2}eos (CHARACTER, default: \enquote {murn})}{10}{subsubsection.4.2.2}%
\contentsline {subsubsection}{\numberline {4.2.3}List of volumes}{10}{subsubsection.4.2.3}%
\contentsline {subsubsection}{\numberline {4.2.4}Output format}{10}{subsubsection.4.2.4}%
\contentsline {subsection}{\numberline {4.3}d3\_lw.x code}{11}{subsection.4.3}%
\contentsline {subsubsection}{\numberline {4.3.1}Namelist \&lwinput}{11}{subsubsection.4.3.1}%
\contentsline {paragraph}{\numberline {4.3.1.1}calculation (CHARACTER, default: \enquote {lw})}{11}{paragraph.4.3.1.1}%
\contentsline {paragraph}{\numberline {4.3.1.2}prefix (CHARACTER, default: the value of calculation)}{11}{paragraph.4.3.1.2}%
\contentsline {paragraph}{\numberline {4.3.1.3}outdir (CHARACTER, default: \enquote {./}, i.e.\nobreakspace {}the current directory)}{11}{paragraph.4.3.1.3}%
\contentsline {paragraph}{\numberline {4.3.1.4}file\_mat2 (CHARACTER, no default)}{11}{paragraph.4.3.1.4}%
\contentsline {paragraph}{\numberline {4.3.1.5}file\_mat3 (CHARACTER, no default)}{11}{paragraph.4.3.1.5}%
\contentsline {paragraph}{\numberline {4.3.1.6}asr2 (CHARACTER, default: \enquote {no})}{12}{paragraph.4.3.1.6}%
\contentsline {paragraph}{\numberline {4.3.1.7}nq (INTEGER, no default)}{12}{paragraph.4.3.1.7}%
\contentsline {paragraph}{\numberline {4.3.1.8}nconf (INTEGER, no default)}{12}{paragraph.4.3.1.8}%
\contentsline {paragraph}{\numberline {4.3.1.9}nk (3x INTEGER, no default)}{12}{paragraph.4.3.1.9}%
\contentsline {paragraph}{\numberline {4.3.1.10}grid\_type (CHARACTER, default: \enquote {simple})}{12}{paragraph.4.3.1.10}%
\contentsline {paragraph}{\numberline {4.3.1.11}xk0 (3x REAL, default: 0,0,0)}{12}{paragraph.4.3.1.11}%
\contentsline {paragraph}{\numberline {4.3.1.12}ne, de, e0, sigma\_e (INTEGER, REAL, REAL, in cm-1 no default)}{12}{paragraph.4.3.1.12}%
\contentsline {paragraph}{\numberline {4.3.1.13}nu\_initial (1..3×nat, no default)}{12}{paragraph.4.3.1.13}%
\contentsline {paragraph}{\numberline {4.3.1.14}e\_initial (in cm-1, no default)}{12}{paragraph.4.3.1.14}%
\contentsline {paragraph}{\numberline {4.3.1.15}q\_initial (3x REAL, in units of 2π/alat)}{12}{paragraph.4.3.1.15}%
\contentsline {paragraph}{\numberline {4.3.1.16}q\_summed (LOGICAL, default: false)}{13}{paragraph.4.3.1.16}%
\contentsline {paragraph}{\numberline {4.3.1.17}q\_resolved (LOGICAL, default: false)}{13}{paragraph.4.3.1.17}%
\contentsline {paragraph}{\numberline {4.3.1.18}sigmaq (REAL, default: 0.1 in units of 2π/alat)}{13}{paragraph.4.3.1.18}%
\contentsline {paragraph}{\numberline {4.3.1.19}exp\_t\_factor (LOGICAL, default: false)}{13}{paragraph.4.3.1.19}%
\contentsline {paragraph}{\numberline {4.3.1.20}sort\_freq (CHARACTER, default: \enquote {default})}{13}{paragraph.4.3.1.20}%
\contentsline {paragraph}{\numberline {4.3.1.21}isotopic\_disorder (LOGICAL, default: false)}{13}{paragraph.4.3.1.21}%
\contentsline {paragraph}{\numberline {4.3.1.22}casimir\_scattering (LOGICAL, default: false)}{14}{paragraph.4.3.1.22}%
\contentsline {paragraph}{\numberline {4.3.1.23}sample\_dir (3x REAL, normalized, default: no direction)}{14}{paragraph.4.3.1.23}%
\contentsline {paragraph}{\numberline {4.3.1.24}sample\_length\_au (REAL, bohr, no default)}{14}{paragraph.4.3.1.24}%
\contentsline {paragraph}{\numberline {4.3.1.25}sample\_length\_mu (REAL, micrometers, no default)}{14}{paragraph.4.3.1.25}%
\contentsline {paragraph}{\numberline {4.3.1.26}sample\_length\_mm (REAL, millimeters, no default)}{14}{paragraph.4.3.1.26}%
\contentsline {paragraph}{\numberline {4.3.1.27}max\_seconds (no default, in seconds)}{14}{paragraph.4.3.1.27}%
\contentsline {paragraph}{\numberline {4.3.1.28}max\_time (format hh.mmss)}{14}{paragraph.4.3.1.28}%
\contentsline {subsubsection}{\numberline {4.3.2}Output format}{14}{subsubsection.4.3.2}%
\contentsline {subsection}{\numberline {4.4}d3\_tk.x code}{15}{subsection.4.4}%
\contentsline {subsubsection}{\numberline {4.4.1}Namelist \&tkinput}{15}{subsubsection.4.4.1}%
\contentsline {paragraph}{\numberline {4.4.1.1}calculation (CHARACTER, default: \enquote {sma})}{16}{paragraph.4.4.1.1}%
\contentsline {paragraph}{\numberline {4.4.1.2}nk\_in (3x INTEGER, default: same value as nk)}{16}{paragraph.4.4.1.2}%
\contentsline {paragraph}{\numberline {4.4.1.3}grid\_type\_in (CHARACTER, default: same value as grid\_type)}{16}{paragraph.4.4.1.3}%
\contentsline {paragraph}{\numberline {4.4.1.4}xk0\_in (3x REAL, default: same value as xk0)}{16}{paragraph.4.4.1.4}%
\contentsline {paragraph}{\numberline {4.4.1.5}thr\_tk (REAL, default: 1.d-4 W/mK)}{16}{paragraph.4.4.1.5}%
\contentsline {paragraph}{\numberline {4.4.1.6}niter\_max (INTEGER, default: 1000)}{16}{paragraph.4.4.1.6}%
\contentsline {paragraph}{\numberline {4.4.1.7}store\_lw (LOGICAL, default: .false.)}{16}{paragraph.4.4.1.7}%
\contentsline {paragraph}{\numberline {4.4.1.8}intrinsic\_scattering (LOGICAL, default: .true.)}{16}{paragraph.4.4.1.8}%
\contentsline {paragraph}{\numberline {4.4.1.9}restart (LOGICAL, default: .false.)}{16}{paragraph.4.4.1.9}%
\contentsline {paragraph}{\numberline {4.4.1.10}mfp\_cutoff (LOGICAL, default: false)}{17}{paragraph.4.4.1.10}%
\contentsline {paragraph}{\numberline {4.4.1.11}volume\_factor (REAL, default: 1)}{17}{paragraph.4.4.1.11}%
\contentsline {subsubsection}{\numberline {4.4.2}Output format}{17}{subsubsection.4.4.2}%
\contentsline {paragraph}{\numberline {4.4.2.1}SMA calculation}{17}{paragraph.4.4.2.1}%
\contentsline {paragraph}{\numberline {4.4.2.2}CGP calculation}{17}{paragraph.4.4.2.2}%
\contentsline {subsection}{\numberline {4.5}d3\_tdph.x code}{18}{subsection.4.5}%
\contentsline {subsubsection}{\numberline {4.5.1}Namelist \&tdphinput}{18}{subsubsection.4.5.1}%
\contentsline {paragraph}{\numberline {4.5.1.1}ai (CHARACTER, default \enquote {md})}{18}{paragraph.4.5.1.1}%
\contentsline {paragraph}{\numberline {4.5.1.2}fforce, ftau, ftoten (CHARACTER, default \enquote {forces.dat}, \enquote {positions.dat}, \enquote {pioud.dat})}{18}{paragraph.4.5.1.2}%
\contentsline {paragraph}{\numberline {4.5.1.3}fmd (CHARACTER, default \enquote {md.out})}{18}{paragraph.4.5.1.3}%
\contentsline {paragraph}{\numberline {4.5.1.4}file\_mat2 (CHARACTER, default \enquote {mat2R})}{18}{paragraph.4.5.1.4}%
\contentsline {paragraph}{\numberline {4.5.1.5}nfirst, nskip, nread (INTEGER, default 1, 100, 50000)}{18}{paragraph.4.5.1.5}%
\contentsline {paragraph}{\numberline {4.5.1.6}nmax (INTEGER, default: 50000)}{18}{paragraph.4.5.1.6}%
\contentsline {subsubsection}{\numberline {4.5.2}e0 (REAL, default: 0)}{18}{subsubsection.4.5.2}%
\contentsline {subsubsection}{\numberline {4.5.3}basis (CHARACTER, default \enquote {mu})}{19}{subsubsection.4.5.3}%
\contentsline {subsubsection}{\numberline {4.5.4}minimization (CHARACTER, default \enquote {ph})}{19}{subsubsection.4.5.4}%
\contentsline {subsubsection}{\numberline {4.5.5}randomization (REAL, default 0.)}{19}{subsubsection.4.5.5}%
\contentsline {subsection}{\numberline {4.6}Output format}{19}{subsection.4.6}%
\contentsline {subsection}{\numberline {4.7}Common input cards}{19}{subsection.4.7}%
\contentsline {subsubsection}{\numberline {4.7.1}QPOINTS}{19}{subsubsection.4.7.1}%
\contentsline {paragraph}{\numberline {4.7.1.1}cartesian (DEFAULT)}{19}{paragraph.4.7.1.1}%
\contentsline {paragraph}{\numberline {4.7.1.2}crystal}{20}{paragraph.4.7.1.2}%
\contentsline {paragraph}{\numberline {4.7.1.3}grid}{20}{paragraph.4.7.1.3}%
\contentsline {paragraph}{\numberline {4.7.1.4}bz}{20}{paragraph.4.7.1.4}%
\contentsline {paragraph}{\numberline {4.7.1.5}xsf or bxsf}{20}{paragraph.4.7.1.5}%
\contentsline {paragraph}{\numberline {4.7.1.6}plane}{20}{paragraph.4.7.1.6}%
\contentsline {paragraph}{\numberline {4.7.1.7}Examples}{21}{paragraph.4.7.1.7}%
\contentsline {subsubsection}{\numberline {4.7.2}CONFIGS}{21}{subsubsection.4.7.2}%
\contentsline {paragraph}{\numberline {4.7.2.1}Examples}{22}{paragraph.4.7.2.1}%
\contentsline {subsubsection}{\numberline {4.7.3}ISOTOPES}{22}{subsubsection.4.7.3}%
\contentsline {paragraph}{\numberline {4.7.3.1}Examples}{23}{paragraph.4.7.3.1}%
\contentsline {section}{\numberline {5}Input Examples}{23}{section.5}%
\contentsline {subsection}{\numberline {5.1}d3\_lw.x examples}{24}{subsection.5.1}%
\contentsline {subsubsection}{\numberline {5.1.1}Computing the linewidth of a single point}{24}{subsubsection.5.1.1}%
\contentsline {subsubsection}{\numberline {5.1.2}Testing convergence with smearing and grid}{24}{subsubsection.5.1.2}%
\contentsline {subsubsection}{\numberline {5.1.3}Compute the linewidth along a path in the BZ}{26}{subsubsection.5.1.3}%
\contentsline {subsubsection}{\numberline {5.1.4}Compute the spectral function along a path}{26}{subsubsection.5.1.4}%
\contentsline {subsubsection}{\numberline {5.1.5}Compute the final state decomposition}{27}{subsubsection.5.1.5}%
\contentsline {subsubsection}{\numberline {5.1.6}Color-map plot of the LW in the BZ (2D systems)}{29}{subsubsection.5.1.6}%
\contentsline {subsection}{\numberline {5.2}d3\_tk.x examples}{31}{subsection.5.2}%
\contentsline {subsubsection}{\numberline {5.2.1}Compute the SMA solution of the BTE}{31}{subsubsection.5.2.1}%
\contentsline {subsubsection}{\numberline {5.2.2}Compute the exact solution of the BTE}{32}{subsubsection.5.2.2}%
\contentsline {section}{\numberline {6}Bibliography}{32}{section.6}%
\contentsline {section}{\numberline {7}Change Log}{33}{section.7}%
